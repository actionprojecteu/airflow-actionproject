Short-term
==========
* Refacturizar paquete
* Depurar el list de la BD de Mongo con Esteban
  - es la tarea airflow download_from_action

# Lista de subjects que tienen alguna clasificacionn
select distinct subject_id from zooniverse_classification_t where spectrum_type is not null;

# Y paraa cada subject
select user_id, spectrum_type, source_x, source_y from zooniverse_classification_t where subject_id = ;

miramos la cercania de (source_x, source_y) (radio 10 pixels) y si esta cerca
- hacer la clasificacion agregada
Si estan lejos, hacer subgrupos por posicion (source_x, source_y) y hacer la clasificacion agregada


SELECT source_id, source_x, source_y, spectrum_type, user_id
FROM zooniverse_classification_t 
WHERE subject_id = 63339761
ORDER BY source_id ASC;

SELECT source_id, source_x, source_y, spectrum_type, user_id
FROM zooniverse_classification_t 
WHERE subject_id = 63339763
ORDER BY source_id ASC;

UPDATE zooniverse_classification_t
SET source_id = NULL
WHERE source_id IS NOT NULL;

-- AQUI ESTA TODO MENOS EL AGREGADO DE CLASIFICACION
SELECT subject_id, source_id, count(*), AVG(source_x), AVG(source_y),
  image_id, image_url, image_long, image_lat, image_observer, image_comment, image_source, image_created_at
FROM zooniverse_classification_t 
GROUP BY subject_id, source_id
ORDER BY subject_id ASC;


-- marking a source Id with identifier and average coordinates from several observers
SELECT '63339761' || '-' || CAST(ROUND(AVG(a.source_x),0) AS INT) || '-' || CAST(ROUND(AVG(a.source_y),0) AS INT), AVG(a.source_x), AVG(a.source_y)
FROM zooniverse_classification_t AS a
CROSS JOIN zooniverse_classification_t AS b
WHERE a.subject_id = 63339761 
AND b.subject_id = 63339761
AND a.source_x != b.source_x
AND a.source_y != b.source_y
AND ABS(a.source_x - b.source_x) < 5
AND ABS(a.source_y - b.source_y) < 5
;


Test cases
==========
0) Epicollect V tienes observaciones desde el mes 2019-09-01



Mid-term
========
* Upload subject sets de 500-1000. Limite de subject sets es 10000
* transformacion y carga de clasificaciones

Long-term
==========
* reduccion de clasificaciones
 -  ver el estadistico de la kappa de Fleis
    https://en.wikipedia.org/wiki/Fleiss%27_kappa
* integrar con un GIS o bien Generacion de mapa en GUAIX como lo hace Jaime

Otras ideas
===========
1) Street Spectra APP
* generar un uuid por cada observacion
* metadatos similares a epicollect 5
* en el boton de "repetir"
  - No subir imagen
  - en su lugar, añadir "same_as" : uuid de la ultima observacion con imagen
  - pero si añadir nueva marca de tiempo, coordenadas y nickname
